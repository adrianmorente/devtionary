---
  # this playbook will clone the code and will deploy it on the destination host

  - hosts: all

    tasks:
    - name: update apt lists and install node
      become: true
      apt:
        name: nodejs-legacy
        state: build-dep
        update_cache: yes

    - name: install node package manager
      become: true
      apt:
        name: npm

    - name: install node process manager (in order not to lock the service port)
      become: true
      npm:
        name: pm2
        global: yes

    - name: download the corresponding code
      git: repo=https://github.com/adrianmorente/devtionary/ dest=~/devtionary clone=yes